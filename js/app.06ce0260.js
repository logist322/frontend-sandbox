(function(){"use strict";var e={746:function(e,o,t){var n,r=t(144),i=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},a=[],s=t(1),l={},c=(0,s.Z)(l,i,a,!1,null,null,null),m=c.exports,d=t(345),u=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("login-form")},_=[],E=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"login"},[t("form",{staticClass:"login__form"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.room,expression:"room"}],staticClass:"login__input",attrs:{type:"text",placeholder:"Room ID",name:"room_id"},domProps:{value:e.room},on:{input:function(o){o.target.composing||(e.room=o.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.user,expression:"user"}],staticClass:"login__input",attrs:{type:"text",placeholder:"Username",name:"user_id"},domProps:{value:e.user},on:{input:function(o){o.target.composing||(e.user=o.target.value)}}}),t("button",{staticClass:"login__button",attrs:{type:"submit"},on:{click:function(o){return o.preventDefault(),e.enterRoom.apply(null,arguments)}}},[e._v(" Join ")])])])},I=[],O=t(139),f=t(629);(function(e){e["SIGNAL_URL"]="wss://frontend-sandbox-logist322.herokuapp.com/ws/",e["TOKEN"]="helloworld"})(n||(n={}));const v=(e,o)=>n.SIGNAL_URL+e+"/"+o+"?token="+n.TOKEN,p=()=>{const e=new O.vf;return e.device_video(new O.m5),e.audio(new O.xu),e};var S,h,b;r.Z.use(f.ZP),function(e){e["LOCAL_STREAM"]="localStream",e["REMOTE_STREAM"]="remoteStream",e["IS_AUDIO_ENABLED"]="isAudioEnabled",e["IS_VIDEO_ENABLED"]="isVideoEnabled",e["MEMBER_ID"]="memberId"}(S||(S={})),function(e){e["SET_CONNECION_OPTIONS"]="setConnectionOptions",e["INIT_CONNECTION"]="initConnection",e["CONFIGURE_ROOM"]="configureRoom",e["TOGGLE_AUDIO"]="toggleAudio",e["TOGGLE_VIDEO"]="toggleVideo",e["KILL_JASON"]="killJason"}(h||(h={})),function(e){e["SET_USER_ID"]="setUserId",e["SET_ROOM_ID"]="setRoomId",e["JASON_INIT"]="jasonInit",e["ROOM_INIT"]="roomInit",e["DISABLE_AUDIO"]="disableAudio",e["ENABLE_AUDIO"]="enableAudio",e["DISABLE_VIDEO"]="disableVideo",e["ENABLE_VIDEO"]="enableVideo",e["RESET_STATE"]="resetState",e["SET_MEMBER_ID"]="setMemberId"}(b||(b={}));const T={state:{localStream:new MediaStream,remoteStream:new MediaStream,isAudioEnabled:!0,isVideoEnabled:!0,memberId:"",userId:"",roomId:""},getters:{[S.MEMBER_ID](e){return e.memberId},[S.LOCAL_STREAM](e){return e.localStream},[S.REMOTE_STREAM](e){return e.remoteStream},[S.IS_AUDIO_ENABLED](e){return e.isAudioEnabled},[S.IS_VIDEO_ENABLED](e){return e.isVideoEnabled}},actions:{[h.SET_CONNECION_OPTIONS]({commit:e},{user:o,room:t}){e(b.SET_USER_ID,o),e(b.SET_ROOM_ID,t)},async[h.INIT_CONNECTION]({commit:e,dispatch:o}){await(0,O.ZP)(),e(b.JASON_INIT),e(b.ROOM_INIT),await o(h.CONFIGURE_ROOM)},async[h.CONFIGURE_ROOM]({commit:e,state:o}){o.room?.on_failed_local_media((()=>{console.log("Local media failed")})),o.room?.on_connection_loss((()=>{console.log("Connection lost")})),o.room?.on_new_connection((t=>{console.log("Connected"),e(b.SET_MEMBER_ID,{gotMember:t.get_remote_member_id()}),t.on_remote_track_added((e=>{o.remoteStream.addTrack(e.get_track())}))}));const t=p(),n=await(o.jason?.media_manager().init_local_tracks(t).catch((e=>{console.log(e.name())})));n&&n.forEach((e=>{e.kind()===O.D4.Video&&o.localStream.addTrack(e.get_track())})),await(o.room?.set_local_media_settings(t,!1,!1)),o.room?.join(v(o.roomId,o.userId))},[h.TOGGLE_AUDIO]({commit:e,state:o}){o.isAudioEnabled?e(b.DISABLE_AUDIO):e(b.ENABLE_AUDIO)},[h.TOGGLE_VIDEO]({commit:e,state:o}){o.isVideoEnabled?e(b.DISABLE_VIDEO):e(b.ENABLE_VIDEO)},[h.KILL_JASON]({commit:e,state:o}){o.room&&o.jason?.close_room(o.room),o.jason?.dispose(),e(b.RESET_STATE)}},mutations:{[b.SET_USER_ID](e,o){e.userId=o},[b.SET_ROOM_ID](e,o){e.roomId=o},[b.SET_MEMBER_ID](e,{gotMember:o}){e.memberId=o},[b.JASON_INIT](e){e.jason=new O.UH},[b.ROOM_INIT](e){e.room=e.jason?.init_room()},[b.DISABLE_AUDIO](e){e.room?.disable_audio().then((()=>e.isAudioEnabled=!1))},[b.ENABLE_AUDIO](e){e.room?.enable_audio().then((()=>e.isAudioEnabled=!0))},[b.DISABLE_VIDEO](e){e.room?.disable_video().then((()=>e.isVideoEnabled=!1))},[b.ENABLE_VIDEO](e){e.room?.enable_video().then((()=>e.isVideoEnabled=!0))},[b.RESET_STATE](e){e.localStream.getTracks().forEach((o=>{e.localStream.removeTrack(o)})),e.remoteStream.getTracks().forEach((o=>{e.localStream.removeTrack(o)})),e.isAudioEnabled=!0,e.isVideoEnabled=!0,e.userId="",e.roomId=""}}};var A=new f.ZP.Store(T),N=r.Z.extend({name:"LoginForm",data(){return{user:"",room:""}},methods:{...(0,f.nv)([h.SET_CONNECION_OPTIONS]),async enterRoom(){await this.setConnectionOptions({user:this.user,room:this.room}),this.$router.push("room")}}}),D=N,L=(0,s.Z)(D,E,I,!1,null,null,null),g=L.exports,R={components:{LoginForm:g},name:"Login"},C=R,M=(0,s.Z)(C,u,_,!1,null,null,null),w=M.exports,V=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("room-interface")},k=[],y=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"room"},[t("div",{staticClass:"room__name"},[t("p",[e._v(e._s(e.memberId))])]),t("video",{staticClass:"room__remote-video",attrs:{autoplay:""}}),t("video",{directives:[{name:"show",rawName:"v-show",value:e.isVideoEnabled,expression:"isVideoEnabled"}],staticClass:"room__local-video",attrs:{autoplay:""}}),t("media-controls",{attrs:{className:"room__controls"}})],1)},B=[],U=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("ul",{staticClass:"media-controls",class:e.className},[t("li",{staticClass:"media-controls__item media-controls__item--video",class:{"media-controls__item--off":e.isVideoEnabled}},[t("button",{on:{click:e.toggleVideo}},[e._v("Video switch")])]),t("li",{staticClass:"media-controls__item media-controls__item--audio",class:{"media-controls__item--off":e.isAudioEnabled}},[t("button",{on:{click:e.toggleAudio}},[e._v("Audio switch")])]),t("li",{staticClass:"media-controls__item media-controls__item--decline"},[t("button",{on:{click:e.decline}},[e._v("Decline")])])])},x=[],Z=r.Z.extend({name:"MediaControls",beforeDestroy(){this.killJason()},computed:{...(0,f.Se)(["isAudioEnabled","isVideoEnabled"])},methods:{...(0,f.nv)([h.TOGGLE_AUDIO,h.TOGGLE_VIDEO,h.KILL_JASON]),decline(){this.$router.push("/")}},props:{className:{type:String}}}),G=Z,j=(0,s.Z)(G,U,x,!1,null,null,null),P=j.exports,$=r.Z.extend({name:"RoomInterface",components:{MediaControls:P},async mounted(){document.addEventListener("mousemove",this.addMouseMovehandler),await this.initConnection(),this.drawVideos()},computed:{...(0,f.Se)([S.MEMBER_ID,S.LOCAL_STREAM,S.REMOTE_STREAM,S.IS_VIDEO_ENABLED])},methods:{...(0,f.nv)([h.INIT_CONNECTION]),drawVideos(){const e=this.$el.querySelectorAll("video");e.forEach((e=>{e.classList.contains("room__local-video")&&(e.srcObject=this.localStream),e.classList.contains("room__remote-video")&&(e.srcObject=this.remoteStream)}))},addMouseMovehandler(){const e=document.querySelector(".room__name"),o=document.querySelector(".room__controls");e&&(e.classList.remove("hide-up"),setTimeout((()=>{e.classList.add("hide-up")}),1e3)),o&&(o.classList.remove("hide-down"),setTimeout((()=>{o.classList.add("hide-down")}),1e3))}}}),J=$,F=(0,s.Z)(J,y,B,!1,null,null,null),K=F.exports,q={components:{RoomInterface:K}},H=q,z=(0,s.Z)(H,V,k,!1,null,null,null),Q=z.exports;r.Z.use(d.Z);const W=[{path:"/",name:"Login",component:w},{path:"/room",name:"Room",component:Q}],X=new d.Z({mode:"history",base:"",routes:W});var Y=X;r.Z.config.productionTip=!1,new r.Z({router:Y,store:A,render:e=>e(m)}).$mount("#app")}},o={};function t(n){var r=o[n];if(void 0!==r)return r.exports;var i=o[n]={exports:{}};return e[n](i,i.exports,t),i.exports}t.m=e,function(){var e=[];t.O=function(o,n,r,i){if(!n){var a=1/0;for(m=0;m<e.length;m++){n=e[m][0],r=e[m][1],i=e[m][2];for(var s=!0,l=0;l<n.length;l++)(!1&i||a>=i)&&Object.keys(t.O).every((function(e){return t.O[e](n[l])}))?n.splice(l--,1):(s=!1,i<a&&(a=i));if(s){e.splice(m--,1);var c=r();void 0!==c&&(o=c)}}return o}i=i||0;for(var m=e.length;m>0&&e[m-1][2]>i;m--)e[m]=e[m-1];e[m]=[n,r,i]}}(),function(){t.d=function(e,o){for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){t.p=""}(),function(){t.b=document.baseURI||self.location.href;var e={143:0};t.O.j=function(o){return 0===e[o]};var o=function(o,n){var r,i,a=n[0],s=n[1],l=n[2],c=0;if(a.some((function(o){return 0!==e[o]}))){for(r in s)t.o(s,r)&&(t.m[r]=s[r]);if(l)var m=l(t)}for(o&&o(n);c<a.length;c++)i=a[c],t.o(e,i)&&e[i]&&e[i][0](),e[a[c]]=0;return t.O(m)},n=self["webpackChunkfrontend_sandbox"]=self["webpackChunkfrontend_sandbox"]||[];n.forEach(o.bind(null,0)),n.push=o.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(746)}));n=t.O(n)})();
//# sourceMappingURL=app.06ce0260.js.map