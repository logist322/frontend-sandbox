(function(){"use strict";var e={35:function(e,o,t){var n,i=t(144),r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},a=[],s=t(1),l={},c=(0,s.Z)(l,r,a,!1,null,null,null),d=c.exports,m=t(345),u=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("login-form")},_=[],E=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"login"},[t("form",{staticClass:"login__form"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.room,expression:"room"}],staticClass:"login__input",attrs:{type:"text",placeholder:"Room ID"},domProps:{value:e.room},on:{input:function(o){o.target.composing||(e.room=o.target.value)}}}),t("input",{directives:[{name:"model",rawName:"v-model",value:e.user,expression:"user"}],staticClass:"login__input",attrs:{type:"text",placeholder:"Username"},domProps:{value:e.user},on:{input:function(o){o.target.composing||(e.user=o.target.value)}}}),t("button",{staticClass:"login__button",attrs:{type:"submit"},on:{click:function(o){return o.preventDefault(),e.enterRoom.apply(null,arguments)}}},[e._v(" Join ")])])])},O=[],I=t(139),f=t(629);(function(e){e["SIGNAL_URL"]="wss://frontend-sandbox-logist322.herokuapp.com/ws/",e["TOKEN"]="helloworld"})(n||(n={}));const v=(e,o)=>n.SIGNAL_URL+e+"/"+o+"?token="+n.TOKEN,p=()=>{const e=new I.vf;return e.device_video(new I.m5),e.audio(new I.xu),e};var S,h,A;i.Z.use(f.ZP),function(e){e["LOCAL_STREAM"]="localStream",e["REMOTE_STREAM"]="remoteStream",e["IS_AUDIO_ENABLED"]="isAudioEnabled",e["IS_VIDEO_ENABLED"]="isVideoEnabled"}(S||(S={})),function(e){e["SET_CONNECION_OPTIONS"]="setConnectionOptions",e["INIT_CONNECTION"]="initConnection",e["CONFIGURE_ROOM"]="configureRoom",e["TOGGLE_AUDIO"]="toggleAudio",e["TOGGLE_VIDEO"]="toggleVideo",e["KILL_JASON"]="killJason"}(h||(h={})),function(e){e["SET_USER_ID"]="setUserId",e["SET_ROOM_ID"]="setRoomId",e["JASON_INIT"]="jasonInit",e["ROOM_INIT"]="roomInit",e["DISABLE_AUDIO"]="disableAudio",e["ENABLE_AUDIO"]="enableAudio",e["DISABLE_VIDEO"]="disableVideo",e["ENABLE_VIDEO"]="enableVideo",e["RESET_STATE"]="resetState"}(A||(A={}));const T={state:{localStream:new MediaStream,remoteStream:new MediaStream,isAudioEnabled:!0,isVideoEnabled:!0,userId:"",roomId:""},getters:{[S.LOCAL_STREAM](e){return e.localStream},[S.REMOTE_STREAM](e){return e.remoteStream},[S.IS_AUDIO_ENABLED](e){return e.isAudioEnabled},[S.IS_VIDEO_ENABLED](e){return e.isVideoEnabled}},actions:{[h.SET_CONNECION_OPTIONS]({commit:e},{user:o,room:t}){e(A.SET_USER_ID,o),e(A.SET_ROOM_ID,t)},async[h.INIT_CONNECTION]({commit:e,dispatch:o}){await(0,I.ZP)(),e(A.JASON_INIT),e(A.ROOM_INIT),await o(h.CONFIGURE_ROOM)},async[h.CONFIGURE_ROOM]({state:e}){e.room?.on_failed_local_media((()=>{console.log("Local media failed")})),e.room?.on_connection_loss((()=>{console.log("Connection lost")})),e.room?.on_new_connection((o=>{console.log("Connected"),o.on_remote_track_added((o=>{e.remoteStream.addTrack(o.get_track())}))}));const o=p(),t=await(e.jason?.media_manager().init_local_tracks(o).catch((e=>{console.log(e.name())})));t&&t.forEach((o=>{o.kind()===I.D4.Video&&e.localStream.addTrack(o.get_track())})),await(e.room?.set_local_media_settings(o,!1,!1)),e.room?.join(v(e.roomId,e.userId))},[h.TOGGLE_AUDIO]({commit:e,state:o}){o.isAudioEnabled?e(A.DISABLE_AUDIO):e(A.ENABLE_AUDIO)},[h.TOGGLE_VIDEO]({commit:e,state:o}){o.isVideoEnabled?e(A.DISABLE_VIDEO):e(A.ENABLE_VIDEO)},[h.KILL_JASON]({commit:e,state:o}){o.room&&o.jason?.close_room(o.room),o.jason?.dispose(),e(A.RESET_STATE)}},mutations:{[A.SET_USER_ID](e,o){e.userId=o},[A.SET_ROOM_ID](e,o){e.roomId=o},[A.JASON_INIT](e){e.jason=new I.UH},[A.ROOM_INIT](e){e.room=e.jason?.init_room()},[A.DISABLE_AUDIO](e){e.room?.disable_audio().then((()=>e.isAudioEnabled=!1))},[A.ENABLE_AUDIO](e){e.room?.enable_audio().then((()=>e.isAudioEnabled=!0))},[A.DISABLE_VIDEO](e){e.room?.disable_video().then((()=>e.isVideoEnabled=!1))},[A.ENABLE_VIDEO](e){e.room?.enable_video().then((()=>e.isVideoEnabled=!0))},[A.RESET_STATE](e){e.localStream.getTracks().forEach((o=>{e.localStream.removeTrack(o)})),e.remoteStream.getTracks().forEach((o=>{e.localStream.removeTrack(o)})),e.isAudioEnabled=!0,e.isVideoEnabled=!0,e.userId="",e.roomId=""}}};var N=new f.ZP.Store(T),b=i.Z.extend({name:"LoginForm",data(){return{user:"",room:""}},methods:{...(0,f.nv)([h.SET_CONNECION_OPTIONS]),async enterRoom(){await this.setConnectionOptions({user:this.user,room:this.room}),this.$router.push("room")}}}),L=b,g=(0,s.Z)(L,E,O,!1,null,null,null),D=g.exports,C={components:{LoginForm:D},name:"Login"},w=C,R=(0,s.Z)(w,u,_,!1,null,null,null),V=R.exports,M=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("room-interface")},k=[],y=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"room"},[e._m(0),t("video",{staticClass:"room__remote-video",attrs:{autoplay:""}}),t("video",{directives:[{name:"show",rawName:"v-show",value:e.isVideoEnabled,expression:"isVideoEnabled"}],staticClass:"room__local-video",attrs:{autoplay:""}}),t("media-controls",{attrs:{className:"room__controls"}})],1)},U=[function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"room__name"},[t("p",[e._v("Ferris")])])}],x=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("ul",{staticClass:"media-controls",class:e.className},[t("li",{staticClass:"media-controls__item media-controls__item--video",class:{"media-controls__item--off":e.isVideoEnabled}},[t("button",{on:{click:e.toggleVideo}},[e._v("Video switch")])]),t("li",{staticClass:"media-controls__item media-controls__item--audio",class:{"media-controls__item--off":e.isAudioEnabled}},[t("button",{on:{click:e.toggleAudio}},[e._v("Audio switch")])]),t("li",{staticClass:"media-controls__item media-controls__item--decline"},[t("button",{on:{click:e.decline}},[e._v("Decline")])])])},Z=[],B=i.Z.extend({name:"MediaControls",beforeDestroy(){this.killJason()},computed:{...(0,f.Se)(["isAudioEnabled","isVideoEnabled"])},methods:{...(0,f.nv)([h.TOGGLE_AUDIO,h.TOGGLE_VIDEO,h.KILL_JASON]),decline(){this.$router.push("/")}},props:{className:{type:String}}}),G=B,j=(0,s.Z)(G,x,Z,!1,null,null,null),$=j.exports,P=i.Z.extend({name:"RoomInterface",components:{MediaControls:$},async mounted(){document.addEventListener("mousemove",this.addMouseMovehandler),await this.initConnection(),this.drawVideos()},computed:{...(0,f.Se)([S.LOCAL_STREAM,S.REMOTE_STREAM,S.IS_VIDEO_ENABLED])},methods:{...(0,f.nv)([h.INIT_CONNECTION]),drawVideos(){const e=this.$el.querySelectorAll("video");e.forEach((e=>{e.classList.contains("room__local-video")&&(e.srcObject=this.localStream),e.classList.contains("room__remote-video")&&(e.srcObject=this.remoteStream)}))},addMouseMovehandler(){const e=document.querySelector(".room__name"),o=document.querySelector(".room__controls");e&&(e.classList.remove("hide-up"),setTimeout((()=>{e.classList.add("hide-up")}),1e3)),o&&(o.classList.remove("hide-down"),setTimeout((()=>{o.classList.add("hide-down")}),1e3))}}}),J=P,F=(0,s.Z)(J,y,U,!1,null,null,null),K=F.exports,q={components:{RoomInterface:K}},H=q,z=(0,s.Z)(H,M,k,!1,null,null,null),Q=z.exports;i.Z.use(m.Z);const W=[{path:"/",name:"Login",component:V},{path:"/room",name:"Room",component:Q}],X=new m.Z({mode:"history",base:"/",routes:W});var Y=X;i.Z.config.productionTip=!1,new i.Z({router:Y,store:N,render:e=>e(d)}).$mount("#app")}},o={};function t(n){var i=o[n];if(void 0!==i)return i.exports;var r=o[n]={exports:{}};return e[n](r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(o,n,i,r){if(!n){var a=1/0;for(d=0;d<e.length;d++){n=e[d][0],i=e[d][1],r=e[d][2];for(var s=!0,l=0;l<n.length;l++)(!1&r||a>=r)&&Object.keys(t.O).every((function(e){return t.O[e](n[l])}))?n.splice(l--,1):(s=!1,r<a&&(a=r));if(s){e.splice(d--,1);var c=i();void 0!==c&&(o=c)}}return o}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[n,i,r]}}(),function(){t.d=function(e,o){for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)}}(),function(){t.p="/"}(),function(){t.b=document.baseURI||self.location.href;var e={143:0};t.O.j=function(o){return 0===e[o]};var o=function(o,n){var i,r,a=n[0],s=n[1],l=n[2],c=0;if(a.some((function(o){return 0!==e[o]}))){for(i in s)t.o(s,i)&&(t.m[i]=s[i]);if(l)var d=l(t)}for(o&&o(n);c<a.length;c++)r=a[c],t.o(e,r)&&e[r]&&e[r][0](),e[a[c]]=0;return t.O(d)},n=self["webpackChunkfrontend_sandbox"]=self["webpackChunkfrontend_sandbox"]||[];n.forEach(o.bind(null,0)),n.push=o.bind(null,n.push.bind(n))}();var n=t.O(void 0,[998],(function(){return t(35)}));n=t.O(n)})();
//# sourceMappingURL=app.2b28df58.js.map